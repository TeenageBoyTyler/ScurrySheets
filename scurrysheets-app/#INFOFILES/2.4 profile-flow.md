# Profile Settings Flow

## Overview
The Profile Settings area serves as the configuration center for the application, focusing exclusively on user settings and cloud service connections. The interface maintains the minimalist approach while providing essential tools for application configuration.

## Profile Home
**Fullscreen settings overview**

- Clean, minimalist layout with user information at top
- Connected Google Drive storage indication with status
- Usage statistics (e.g., "124 Documents", "15 Tags")
- Simple, focused design with clear entry points to configuration sections
- Connection status indicator with current state (connected/disconnected)
- **Implementation**: 
  - SvelteKit page component with reactive data bindings
  - Supabase Authentication for user information
  - Svelte stores for reactive state management

## Section: Processing Information
**Google Cloud Vision API key management**

- Status indicator showing validity of user's Google Vision API key
- User's personal Vision API key information (partially masked)
- Option to update or change Vision API key
- **Usage Dashboard**:
  - Real-time API usage monitoring via Cloud Monitoring API
  - Visual progress bar showing current monthly usage
  - Color-coded indicators (green/yellow/red) based on quota consumption
  - Free tier limits explanation (1,000 units per month)
  - Last updated timestamp with manual refresh option
  - Direct link to Google Cloud Console for detailed monitoring
  - **Implementation**: 
    - Svelte component with reactive progress indicators
    - Supabase Database for API key storage with RLS protection
    - Supabase Edge Functions for secure API key validation
- Brief explanation of OCR capabilities:
  - "Text extraction from all your documents"
  - "Handwriting recognition and removal"
  - "Full-text search across your document library"
- **Feature Information**:
  - Simple visual indicators showing supported document types
  - Clear explanation of handwriting removal limitations
  - Expected processing times for different document types
- Connection test button to verify Google Cloud Vision API key validity
- Simple toast message for connection status (success/failure)
- Warning messages when approaching quota limits (70%, 90%)
- Automatic prevention of operations that would exceed the monthly free tier
- **OCR Settings** (minimalist toggles):
  - Language detection toggle (auto/manual)
  - Default handwriting removal preference
  - Text confidence threshold slider (affects search accuracy)
  - API usage efficiency options (affects cost vs. quality)
  - **Implementation**: 
    - Svelte form components with reactive state
    - SvelteKit form actions for settings updates
    - Svelte transitions for UI updates
- **Storage Implementation**:
  - API keys securely stored in the user_settings table with RLS protection
  - Settings synchronized across devices via Supabase Realtime
  - User preferences cached locally via Svelte stores

## Section: Cloud Storage Connection
**Google Drive management**

- Google Drive connection status
- Storage usage visualization
- Metadata storage location (.scurrysheets folder)
- Connection status indicator with last successful sync time
- Supabase Storage usage for caching and metadata
- **Implementation**:
  - Google Drive API integration via Supabase Auth
  - Supabase Auth for token management
  - SvelteKit API endpoints for secure operations
  - Svelte components for visualizations

## Section: Network Status
**Connection information**

- Current connection status (connected/disconnected)
- Last successful sync time
- Simple explanation of network requirements
- Reference to "all-or-nothing" upload approach
- Clear description of how connection loss is handled during uploads
- **Implementation**:
  - Svelte store for network status tracking
  - Reactive UI updates on connectivity changes
  - SvelteKit integration with browser network APIs
  - Toast notifications for status changes

## GitHub Codespaces Development
**Development environment configuration**

- Configured for seamless development with GitHub Codespaces
- `.devcontainer` configuration for consistent development environment
- Port forwarding for local development server
- Environment variables for local development
- Supabase local development setup
- Mock user profiles for development
- Testing tools for simulating network conditions
- Development-specific routes for testing profile settings

## Related Documentation
- For cloud storage structure details, see the Cloud Storage System section in global-systems.md
- For internet connectivity requirements, see the Internet Connectivity Requirements section in global-systems.md
- For cross-device synchronization information, see the Cross-Device Synchronization section in global-systems.md
- For error handling standards, see the Error Handling Guidelines section in global-systems.md